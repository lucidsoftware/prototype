angular.module("lucidCanvas",[]).controller("canvasCtrl",["$scope","$rootScope",function(e,t){e.clickLine=function(){t.selectedType="line"},e.lucidSlides=[{x:368,y:100,height:120,width:160},{x:60,y:210,height:300,width:400},{x:480,y:300,height:300,width:400}],e.blocks=t.currentPage.blocks,t.selectedType="nothing",e.deselectBlock=function(){var e=JSON.parse(JSON.stringify(t.selectedBlock));e.table=!1,t.selectedBlock=e},e.dragoverCallback=function(t,n,c,l){return e.logListEvent("dragged over canvas",t,n,c,l),10>n},e.dropCallback=function(t,n,c,l,r,i){if(e.logListEvent("dropped at canvas",t,n,l,r),l){if("itemType"===i&&!c.label)return!1;if("containerType"===i&&!angular.isArray(c))return!1}return c},e.dropToCanvas=function(e,n){t.saveDocument();var c=t.currentPage.blocks.indexOf(e);if(-1===c&&e){e.metrics||(e={customcolor:!1,swatch:{fill:"#ffffff",text:"#333333",border:"#666666"},swatchnumber:1,borderwidth:3,borderstyle:"solid",text:{verticalalignment:"middle",horizontalalignment:"center",text:e.name,size:"12px"},padding:10,metrics:{z:2,width:120,height:45},shapepanel:!1});var l=angular.element(document.querySelector("#lucid-canvas"))[0].getBoundingClientRect().left,r=angular.element(document.querySelector("#lucid-canvas"))[0].getBoundingClientRect().top;e.metrics.x=n.pageX-l-e.metrics.width/2,e.metrics.y=n.pageY-r-e.metrics.height/2,t.currentPage.blocks.push(e),t.selectedBlock=e}},e.onDragSuccess=function(e,t){if(t.x>250){var n=angular.element(document.querySelector("#lucid-canvas"))[0].getBoundingClientRect().left,c=angular.element(document.querySelector("#lucid-canvas"))[0].getBoundingClientRect().top;if(e){if(angular.element(t.event.srcElement).hasClass("lucid-block-comment"))return;e.metrics.x=t.x-n-t.element.centerX,e.metrics.y=t.y-c-t.element.centerY,e.shapepanel=!1}}}}]);